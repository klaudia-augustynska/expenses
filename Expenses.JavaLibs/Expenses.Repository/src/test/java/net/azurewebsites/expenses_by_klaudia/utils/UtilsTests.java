package net.azurewebsites.expenses_by_klaudia.utils;

import org.junit.Assert;
import org.junit.Test;

public class UtilsTests {

    @Test
    public void GetSalt_ReturnsBase64String() {
        String pattern = "^(?:[A-Za-z0-9+\\/]{4})*(?:[A-Za-z0-9+\\/]{2}==|[A-Za-z0-9+\\/]{3}=)?$";

        String hash = HashUtil.GenerateSalt();

        Assert.assertTrue(hash.matches(pattern));
    }

    @Test
    public void GetSalt_ReturnsDifferentValues() {
        int n = 10;
        String[] array = new String[n];
        for (int i = 0; i < n; ++i)
            array[i] = HashUtil.GenerateSalt();

        for (int i = 0; i < n; ++i)
            for (int j = 0; j < n; ++j)
                if (i != j)
                    Assert.assertNotEquals(array[i], array[j]);
    }

    @Test
    public void Hash_SameResultsAsInNetFramework(){
        String hash1 = HashUtil.Hash("haslo", "solniczka0123456");
        Assert.assertEquals("X2cs/j9kHsXOZiykA0V9EFs3mZQ=", hash1);

        String hash2 = HashUtil.Hash("pawel", "klaudia890123456");
        Assert.assertEquals("zGQSDK4F3CgEE2DBVgn/KSxqNYI=", hash2);

        String hash3 = HashUtil.Hash("torun", "bydgoszcz0123456");
        Assert.assertEquals("nSMZcUOE6RJKXug0Trdc+RIucwM=", hash3);
    }
}
